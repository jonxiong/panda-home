# 前端性能优化-执行

- [前端性能优化-执行](#前端性能优化-执行)
  - [动画性能](#动画性能)
  - [大量数据性能优化](#大量数据性能优化)
    - [虚拟列表](#虚拟列表)
    - [Web Worker: 进行多线程编程](#web-worker-进行多线程编程)

## 动画性能

> 动画性能不仅在前端, 在任何客户端技术中心都是性能的重灾区, 归根到底是需要大量的计算和渲染工作, 远超普通的静态U

* 尽量将动画放在一个独立图层, 这样可以避免动画效果影响其他渲染层的元素
* 尽量避免回流和重绘
* 尽量使用GPU, 速度更快
* requestAnimationFrame

## 大量数据性能优化

> 我们在实际开发过程中会碰到一种场景, 前端需要渲染大量数据(几千行数万行数据不等), 而且还不允许分页, 这种情况下网页会出现掉帧、卡顿甚至假死的情况

### 虚拟列表

* 可滚动区域：假设有 1000 条数据，每个列表项的高度是 30，那么可滚动的区域的高度就是 1000 * 30。当用户改变列表的滚动条的当前滚动值的时候，会造成可见区域的内容的变更。
* 可见区域：比如列表的高度是 300，右侧有纵向滚动条可以滚动，那么视觉可见的区域就是可见区域。 实现虚拟列表就是处理滚动条滚动后的可见区域的变更，其中具体步骤如下：
  + 计算当前可见区域起始数据的 startIndex
  + 计算当前可见区域结束数据的 endIndex
  + 计算当前可见区域的数据，并渲染到页面中
  + 计算 startIndex 对应的数据在整个列表中的偏移位置 startOffset，并设置到列表上

### Web Worker: 进行多线程编程

> Web Worker 是一个独立的线程（独立的执行环境），这就意味着它可以完全和 UI 线程（主线程）并行的执行 js 代码，从而不会阻塞 UI，它和主线程是通过 onmessage 和 postMessage 接口进行通信的

Web Worker 使得网页中进行多线程编程成为可能。当主线程在处理界面事件时，worker 可以在后台运行，帮你处理大量的数据计算，当计算完成，将计算结果返回给主线程，由主线程更新 DOM 元素
